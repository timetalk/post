(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{14:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n.n(s),c=n(6),o=n.n(c),l=(n(14),n(8)),i=n(9),r=n(7),d=n(2);function u(e){var t=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),s=0;s<n.length;s++){var a=n[s].trim();if(a.substring(0,e.length+1)===e+"="){t=decodeURIComponent(a.substring(e.length+1));break}}return t}var j=n(0);function b(){return Object(j.jsx)("div",{className:"container mt-5",children:Object(j.jsx)("div",{className:"row",children:Object(j.jsx)("div",{className:"col-12 col-md-6 col-sm-12 mx-auto",children:Object(j.jsx)("div",{className:"mr-auto",children:Object(j.jsx)("button",{type:"button",className:"btn btn-primary me-auto rounded-circle","data-bs-toggle":"modal","data-bs-target":"#exampleModal",children:"+"})})})})})}function p(e){var t=e.username,n=Object(s.useState)([]),a=Object(d.a)(n,2),c=a[0],o=a[1],l=Object(s.useState)([]),i=Object(d.a)(l,2),u=i[0],b=i[1];return Object(s.useEffect)((function(){var t=Object(r.a)(e.newPosts).concat(c);t.length!==u.length&&b(t)}),[u,e.newPosts,c]),Object(s.useEffect)((function(){!function(e,t){var n="http://127.0.0.1:8000/api/post/";e&&(n="http://127.0.0.1:8000/api/post/?username=".concat(e));var s=new XMLHttpRequest;s.responseType="json",s.open("GET",n),s.setRequestHeader("Content-Type","application/json"),s.onload=function(){t(s.response,s.status)},s.send()}(t,(function(e,t){200===t&&o(e)}))}),[t]),Object(j.jsx)("div",{className:"container mt-5",children:u.map((function(e,t){return Object(j.jsx)(m,{post:e},"".concat(t))}))})}function m(e){var t=e.post,n=Object(s.useState)(e.post?e.post:null),c=Object(d.a)(n,2),o=c[0],i=c[1],r=window.location.pathname,u=Object(l.a)(/([0-9]+)/,{postId:1}),b=r.match(u),p=b?b.groups.postId:-1,m="".concat(t.id)!=="".concat(p),h=function(e){i(e)};return Object(j.jsx)("div",{className:"row mt-3",children:Object(j.jsx)("div",{className:"col-12 col-md-6 col-sm-12 mx-auto",children:Object(j.jsxs)("div",{className:"card h-100",children:[Object(j.jsx)("img",{src:"http://127.0.0.1:8000/".concat(t.image,"/"),className:"card-img-top",alt:"..."}),Object(j.jsxs)("div",{className:"card-body",children:[Object(j.jsx)("h5",{className:"card-title",children:t.title}),Object(j.jsx)("p",{className:"card-text",children:t.content}),Object(j.jsx)("div",{children:Object(j.jsx)("small",{className:"text-muted",children:t.timestamp})}),Object(j.jsxs)("div",{className:"btn btn-group",children:[o&&Object(j.jsxs)(a.a.Fragment,{children:[Object(j.jsx)(f,{post:o,didLike:h,action:{type:"like",display:"like"}}),Object(j.jsx)(f,{post:o,didLike:h,action:{type:"unlike",display:"unlike"}})]}),!1===m?null:Object(j.jsx)("button",{className:"btn btn-outline-primary btn-sm",onClick:function(e){e.preventDefault(),window.location.href="/".concat(t.id)},children:"views the post"})]})]})]})})})}function f(e){var t=e.post,n=e.action,s=e.didLike,a=t.like?t.like:0,c=e.className?e.className:"btn btn-primary btn-sm",o=n.display?n.display:"Action",l="like"===n.type?"".concat(a," ").concat(o):o;return Object(j.jsx)("button",{className:c,onClick:function(e){e.preventDefault();!function(e,t){var n;e&&(n=JSON.stringify(e));var s=new XMLHttpRequest,a=u("csrftoken");s.responseType="json",s.open("POST","http://127.0.0.1:8000/api/post/action/"),s.setRequestHeader("Content-Type","application/json"),a&&(s.setRequestHeader("X-CSRFToken",a),s.setRequestHeader("HTTP_X_REQUESTED_WITH","XMLHttpRequest"),s.setRequestHeader("Http-Requested-With","XMLHttpRequest")),s.onload=function(){t(s.response,s.status)},s.send(n)}({id:t.id,action:n.type},(function(e,t){200!==t&&201!==t||!s||s(e)}))},children:l})}function h(e){var t=e.postId,n=Object(s.useState)(null),a=Object(d.a)(n,2),c=a[0],o=a[1];return function(e,t){var n=new XMLHttpRequest,s="http://127.0.0.1:8000/api/post/".concat(e);n.responseType="json",n.open("GET",s),n.setRequestHeader("Content-Type","application/json"),n.onload=function(){t(n.response,n.status)},n.send()}(t,(function(e,t){200===t&&o(e)})),null!==c?Object(j.jsx)(m,{post:c}):null}var O=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),s(e),a(e),c(e),o(e)}))},x=a.a.createElement,v=document.getElementById("root");v&&o.a.render(x((function(e){var t="false"!==e.canPost;console.log(t);var n=a.a.createRef(),c=a.a.createRef(),o=a.a.createRef(),l=Object(s.useState)([]),m=Object(d.a)(l,2),f=m[0],h=m[1],O=function(e,t){var n=Object(r.a)(f);201===t?(n.unshift(e),h(n)):alert("An error occured please try again letter !")};return Object(j.jsxs)("div",{children:[t&&Object(j.jsx)(b,{}),Object(j.jsx)("div",{className:"modal fade",id:"exampleModal","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(j.jsx)("div",{className:"modal-dialog",children:Object(j.jsxs)("div",{className:"modal-content",children:[Object(j.jsxs)("div",{className:"modal-header",children:[Object(j.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Post"}),Object(j.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(j.jsx)("div",{className:"modal-body",children:Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=n.current.files[0],s=o.current.value,a=c.current.value,l=new FormData;l.append("title",a),l.append("content",s),l.append("image",t),function(e,t){var n;e&&(n=e);var s=new XMLHttpRequest,a=u("csrftoken");s.responseType="json",s.open("POST","http://127.0.0.1:8000/api/post/create/"),a&&(s.setRequestHeader("X-CSRFToken",a),s.setRequestHeader("HTTP_X_REQUESTED_WITH","XMLHttpRequest"),s.setRequestHeader("Http-Requested-With","XMLHttpRequest")),s.onload=function(){t(s.response,s.status)},s.send(n)}(l,O),o.current.value="",c.current.value="",n.current.value=null},children:[Object(j.jsxs)("div",{className:"mb-3",children:[Object(j.jsx)("label",{className:"form-label",children:"Title"}),Object(j.jsx)("input",{type:"text",className:"form-control",ref:c,placeholder:"title"})]}),Object(j.jsxs)("div",{className:"mb-3",children:[Object(j.jsx)("label",{className:"form-label",children:"Content "}),Object(j.jsx)("textarea",{className:"form-control",rows:"3",ref:o})]}),Object(j.jsxs)("div",{className:"mb-3",children:[Object(j.jsx)("label",{className:"form-label",children:"Upload file"}),Object(j.jsx)("input",{className:"form-control",type:"file",ref:n})]}),Object(j.jsxs)("div",{className:"modal-footer",children:[Object(j.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"}),Object(j.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Post"})]})]})})]})})}),Object(j.jsx)(p,Object(i.a)({newPosts:f},e))]})}),v.dataset),v);var N=document.querySelectorAll(".post-detail-el");N.forEach((function(e){N&&o.a.render(x(h,e.dataset),e)})),O()}},[[16,1,2]]]);
//# sourceMappingURL=main.63a0fdc7.chunk.js.map